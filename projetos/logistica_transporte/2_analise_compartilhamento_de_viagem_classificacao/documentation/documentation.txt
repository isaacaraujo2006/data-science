Projeto: Analise compartilhamento de viagem classificacao

Dataset: D:\Github\data-science\projetos\logistica_transporte\2_analise_compartilhamento_de_viagem_classificacao\data\raw\logistica_transportadora_2018_2022.csv

# üöÄ **2. Renomea√ß√£o das colunas**
colunas = {
    'Trip ID': 'id_viagem',
    'Trip Start Timestamp': 'data_inicio',
    'Trip End Timestamp': 'data_final',
    'Trip Seconds': 'segundos_da_viagem',
    'Trip Miles': 'milhas_da_viagem',
    'Pickup Census Tract': 'trato_do_censo_do_embarque',
    'Dropoff Census Tract': 'trato_do_censo_do_desembarque',
    'Pickup Community Area': 'area_comunitaria_do_embarque',
    'Dropoff Community Area': 'area_comunitaria_do_desembarque',
    'Fare': 'tarifa',
    'Tip': 'gorjeta',
    'Additional Charges': 'cobrancas_adicionais',
    'Trip Total': 'total_da_viagem',
    'Shared Trip Authorized': 'viagem_compartilhada_autorizada',
    'Trips Pooled': 'viagens_agrupadas',
    'Pickup Centroid Latitude': 'latitude_do_centroide_do_embarque',
    'Pickup Centroid Longitude': 'longitude_do_centroide_do_embarque',
    'Dropoff Centroid Latitude': 'latitude_do_centroide_do_desembarque',
    'Dropoff Centroid Longitude': 'longitude_do_centroide_do_desembarque'
	
# üöÄ **3. Tipo de dado de cada coluna**
data columns (total 21 columns):
 #   Column                                 Non-Null Count  Dtype
---  ------                                 --------------  -----
 0   id_viagem                              48112 non-null  object
 1   data_inicio                            48112 non-null  object
 2   data_final                             48112 non-null  object
 3   segundos_da_viagem                     48110 non-null  float64
 4   milhas_da_viagem                       48112 non-null  float64
 5   trato_do_censo_do_embarque             34238 non-null  float64
 6   trato_do_censo_do_desembarque          34155 non-null  float64
 7   area_comunitaria_do_embarque           45263 non-null  float64
 8   area_comunitaria_do_desembarque        45051 non-null  float64
 9   tarifa                                 48112 non-null  float32
 10  gorjeta                                48112 non-null  float64
 11  cobrancas_adicionais                   48112 non-null  float64
 12  total_da_viagem                        48112 non-null  float64
 13  viagem_compartilhada_autorizada        48112 non-null  category
 14  viagens_agrupadas                      48112 non-null  float64
 15  latitude_do_centroide_do_embarque      45297 non-null  float64
 16  longitude_do_centroide_do_embarque     45297 non-null  float64
 17  Pickup Centroid Location               45297 non-null  object
 18  latitude_do_centroide_do_desembarque   45088 non-null  float64
 19  longitude_do_centroide_do_desembarque  45088 non-null  float64
 20  Dropoff Centroid Location              45088 non-null  object
dtypes: category(1), float32(1), float64(14), object(5)

# üöÄ **4. Classifica√ß√£o das colunas: N√∫mericas, Categ√≥ricas e Temporais**

- Vari√°veis Temporais
  - data_inicio
    - Tipo: Temporal (timestamp)
    - Relev√¢ncia:
      - Permite extrair informa√ß√µes de sazonalidade (dia da semana, hora do dia, m√™s) que podem influenciar a demanda e o comportamento das viagens.
      - Fundamental para calcular a dura√ß√£o real da viagem (em conjunto com data_final).

  - data_final
    - Tipo: Temporal (timestamp)
    - Relev√¢ncia:
      - Em conjunto com data_inicio, possibilita a valida√ß√£o e o c√°lculo da dura√ß√£o da viagem.
      - Pode ajudar a identificar padr√µes de t√©rmino (por exemplo, hor√°rios de pico ou per√≠odos com menor demanda).

- Vari√°veis Num√©ricas (Cont√≠nuas ou Discretas)
  - segundos_da_viagem
    - Tipo: Num√©rica (cont√≠nua)
    - Relev√¢ncia:
      - Indicador direto da dura√ß√£o da viagem em segundos.
      - √ötil para an√°lises de efici√™ncia e para modelar rela√ß√µes entre tempo e custos.

  - milhas_da_viagem
    - Tipo: Num√©rica (cont√≠nua)
    - Relev√¢ncia:
      - Representa a dist√¢ncia percorrida, servindo para avaliar custos, consumo de combust√≠vel e a efici√™ncia de rotas.

  - tarifa
    - Tipo: Num√©rica (cont√≠nua)
    - Relev√¢ncia:
      - Base para o c√°lculo do custo da viagem.
      - Pode ser correlacionada com dist√¢ncia, dura√ß√£o e localiza√ß√£o.

  - gorjeta
    - Tipo: Num√©rica (cont√≠nua)
    - Relev√¢ncia:
      - Indicador do comportamento do usu√°rio e da satisfa√ß√£o com o servi√ßo.
      - Ajuda a entender a variabilidade na remunera√ß√£o dos motoristas e a influ√™ncia de fatores externos.

   - cobrancas_adicionais
     - Tipo: Num√©rica (cont√≠nua)
     - Relev√¢ncia:
       - Reflete encargos extras aplicados √† viagem (como taxas de ped√°gio ou servi√ßos adicionais).
       - Essencial para uma vis√£o completa do custo total.

   - total_da_viagem
     - Tipo: Num√©rica (cont√≠nua)
     - Relev√¢ncia:
       - Soma de tarifa, gorjeta e cobran√ßas adicionais.
       - Vari√°vel chave para an√°lises de receita, faturamento e avalia√ß√£o econ√¥mica do servi√ßo.

   - latitude_do_centroide_do_embarque e longitude_do_centroide_do_embarque
     - Tipo: Num√©ricas (cont√≠nuas)
     - Relev√¢ncia:
       - Coordenadas geogr√°ficas do ponto central do embarque.
       - Permitem an√°lises espaciais e a identifica√ß√£o de clusters ou hotspots de demanda.

   - latitude_do_centroide_do_desembarque e longitude_do_centroide_do_desembarque
     - Tipo: Num√©ricas (cont√≠nuas)
     - Relev√¢ncia:
       - Coordenadas do ponto central do desembarque.
       - Auxiliam no mapeamento dos destinos e na an√°lise de padr√µes de deslocamento.

- Vari√°veis Categ√≥ricas (ou Identificadores)

   - id_viagem
     - Tipo: Identificador √∫nico (pode ser tratado como categ√≥rico ou string)
     - Relev√¢ncia:
       - Serve para identificar individualmente cada registro.
       - Geralmente n√£o √© utilizada como feature preditiva, mas √© √∫til para jun√ß√µes e rastreamento de dados.

   - trato_do_censo_do_embarque
     - Tipo: Categ√≥rica (ou discreta, dependendo de como os dados s√£o codificados)
     - Relev√¢ncia:
       - Reflete a divis√£o geogr√°fica (censo) do local de embarque.
       - Pode indicar √°reas com maior concentra√ß√£o de chamadas ou identificar regi√µes de alta demanda.

   - trato_do_censo_do_desembarque
     - Tipo: Categ√≥rica (ou discreta)
     - Relev√¢ncia:
       - Similar ao embarque, mas para o local de desembarque.
       - √ötil para compreender a distribui√ß√£o espacial dos destinos das viagens.

   - area_comunitaria_do_embarque
     - Tipo: Categ√≥rica
     - Relev√¢ncia:
       - Indica a √°rea comunit√°ria do embarque.
       - Ajuda na segmenta√ß√£o geogr√°fica e na identifica√ß√£o de bairros ou zonas com caracter√≠sticas particulares de demanda.

   - area_comunitaria_do_desembarque
     - Tipo: Categ√≥rica
     - Relev√¢ncia:
       - Identifica a √°rea comunit√°ria de desembarque.
       - Auxilia na an√°lise de padr√µes de deslocamento e na avalia√ß√£o de zonas de destino.

   - viagem_compartilhada_autorizada
     - Tipo: Categ√≥rica (geralmente bin√°ria, como Sim/N√£o ou True/False)
     - Relev√¢ncia:
        - Vari√°vel central para o problema de classifica√ß√£o de viagens compartilhadas.
        - Permite analisar os fatores que influenciam a autoriza√ß√£o para o compartilhamento de uma viagem.


   - viagens_agrupadas
     - Tipo: Pode ser num√©rica (por exemplo, contagem) ou categ√≥rica (indicando se a viagem foi agrupada)
     - Relev√¢ncia:
        - Informa se a viagem foi realizada em regime de pooling (agrupamento) e, se num√©rica, quantifica o grau de agrupamento.
        - Essencial para an√°lises de efici√™ncia operacional e para entender a din√¢mica do compartilhamento de viagens.
		
# üöÄ **5. Relat√≥rio incial: Completude, Consistencia, Acuracia e Atualidade. 

1. Completude
A m√©trica de completude indica a propor√ß√£o de registros n√£o nulos para cada coluna:

id_viagem, data_inicio, data_final, milhas_da_viagem, tarifa, gorjeta, cobrancas_adicionais, total_da_viagem, viagem_compartilhada_autorizada, viagens_agrupadas:
Todas apresentam valor 1.0, ou seja, 100% dos registros est√£o preenchidos nessas colunas.

segundos_da_viagem:
Aproximadamente 0.99996 (99,996% dos registros t√™m valor), o que sugere a exist√™ncia de poucos registros com valores ausentes.

trato_do_censo_do_embarque e trato_do_censo_do_desembarque:
Aproximadamente 0.71, indicando que cerca de 29% dos registros est√£o ausentes nessas vari√°veis. Se essas informa√ß√µes forem cr√≠ticas para a an√°lise, pode ser necess√°rio aplicar t√©cnicas de imputa√ß√£o ou avaliar o impacto da sua aus√™ncia.

area_comunitaria_do_embarque e area_comunitaria_do_desembarque:
Valores pr√≥ximos a 0.94, ou seja, 94% dos registros t√™m dados preenchidos, o que √© razo√°vel, mas ainda assim merece aten√ß√£o caso essas vari√°veis sejam determinantes para o modelo ou an√°lise.

latitude/longitude dos centroides e colunas relacionadas a localiza√ß√£o:
Completude em torno de 0.94 a 0.941 para os pontos de embarque e 0.937 para os de desembarque, indicando que h√° uma porcentagem pequena de registros com informa√ß√µes geoespaciais faltantes.

2. Consist√™ncia
Essa m√©trica avalia regras de neg√≥cio e integridade dos dados:

Datas (data_inicio ‚â§ data_final):
Valor de 0.99996 indica que quase todos os registros cumprem a regra temporal esperada (a data de in√≠cio √© anterior ou igual √† data final).

Valores num√©ricos n√£o negativos:
Para as colunas num√©ricas cr√≠ticas (segundos_da_viagem, milhas_da_viagem, tarifa, gorjeta, cobrancas_adicionais e total_da_viagem), a propor√ß√£o de registros com valores n√£o negativos √© praticamente 1.0 (com exce√ß√£o de segundos_da_viagem, que est√° em 0.99996). Isso indica que as regras de integridade para valores num√©ricos est√£o sendo bem respeitadas.

3. Acur√°cia
Tarifa:
O valor de 0.99166 significa que 99,17% dos registros possuem tarifa menor ou igual ao valor do 99¬∫ percentil dessa vari√°vel. Essa abordagem √© um indicativo simples para identificar poss√≠veis outliers. Ou seja, aproximadamente 0,83% dos registros podem ser considerados at√≠picos ou discrepantes, dependendo do contexto.

4. Atualidade
Atualidade_dias:
O valor de 895 dias indica que a data mais recente (em data_inicio) √© de 895 dias atr√°s em rela√ß√£o √† data corrente (no momento do processamento).
Dados_atuais:
Como o crit√©rio adotado √© que os dados devem ter no m√°ximo 30 dias de defasagem, o valor false para dados_atuais demonstra que a base est√° desatualizada.
Implica√ß√£o: Isso pode afetar an√°lises que dependem de dados recentes, como predi√ß√µes de demanda ou comportamento atual dos usu√°rios. Uma a√ß√£o pode ser necess√°ria para atualizar a base ou adaptar o modelo a essa defasagem temporal.

Conclus√£o e Pr√≥ximos Passos
Completude e Consist√™ncia:
Em geral, o dataset apresenta alta completude para a maioria das vari√°veis e boa consist√™ncia nas regras de integridade. No entanto, algumas colunas (como os tratos censit√°rios) possuem uma propor√ß√£o consider√°vel de valores faltantes e podem demandar a√ß√µes espec√≠ficas (imputa√ß√£o, exclus√£o ou cria√ß√£o de uma categoria para "desconhecido").

Acur√°cia:
A presen√ßa de alguns outliers em tarifa deve ser avaliada de acordo com o contexto do neg√≥cio. Pode ser interessante investigar se esses outliers representam casos reais ou erros de entrada.

Atualidade:
A base de dados n√£o est√° atualizada, o que √© um ponto cr√≠tico se a aplica√ß√£o exigir dados recentes. Verifique se esse cen√°rio √© esperado (por exemplo, se a base hist√≥rica √© utilizada para an√°lises retrospectivas) ou se h√° necessidade de atualizar a base para an√°lises preditivas e operacionais.

# üöÄ **6. Relat√≥rio inicial 2:
# Medidas de tend√™ncia central (m√©dia, mediana), dispers√£o (desvio padr√£o, vari√¢ncia, IQR) e assimetria.
# Testes de normalidade (Shapiro-Wilk, Kolmogorov-Smirnov) para entender a distribui√ß√£o dos dados.

Os logs indicam que o pipeline foi executado com sucesso e que a etapa de An√°lise Explorat√≥ria de Dados (EDA) produziu resultados detalhados para cada coluna num√©rica. A seguir, destaco alguns pontos relevantes dos resultados:

Medidas de Tend√™ncia Central e Dispers√£o

Para cada vari√°vel num√©rica foram calculadas a m√©dia, mediana, desvio padr√£o, vari√¢ncia e o IQR.
Por exemplo, para a coluna segundos_da_viagem foi registrada uma m√©dia de aproximadamente 1053,71 e uma mediana de 859, o que, aliado a um alto desvio padr√£o (800,11), sugere uma grande variabilidade nos tempos das viagens.
Assimetria (Skewness)

Muitas vari√°veis apresentam √≠ndices elevados de assimetria.
O caso de segundos_da_viagem (skewness ‚âà 11,33) e gorjeta (skewness ‚âà 4,68) indica distribui√ß√µes fortemente enviesadas, o que pode ser esperado em dados de tempos de viagem e pagamentos, por exemplo.
Testes de Normalidade

Shapiro-Wilk: Para todas as vari√°veis num√©ricas avaliadas, os testes retornaram valores de p iguais a 0.0 (ou muito pr√≥ximos de zero, considerando a precis√£o num√©rica), indicando que, estatisticamente, a hip√≥tese de normalidade pode ser rejeitada para essas vari√°veis.
Kolmogorov-Smirnov (KS): Da mesma forma, os testes KS tamb√©m apresentaram p-valores de 0.0 para todas as colunas, corroborando o achado de que as distribui√ß√µes dos dados se afastam significativamente da normal.
Interpreta√ß√£o Geral

Os resultados dos testes (com p-valores praticamente nulos) sugerem que a maioria das vari√°veis num√©ricas n√£o segue uma distribui√ß√£o normal.
Essa n√£o normalidade pode estar associada a fatores como presen√ßa de outliers, distribui√ß√µes assim√©tricas ou a pr√≥pria natureza dos dados (por exemplo, tempos e valores monet√°rios frequentemente apresentam caudas longas).
Implica√ß√µes para Modelagem e An√°lises Posteriores

Dependendo do modelo a ser aplicado, pode ser necess√°rio considerar transforma√ß√µes (por exemplo, logaritmo ou Box-Cox) para reduzir a assimetria ou adotar modelos robustos a desvios da normalidade.
Al√©m disso, o conhecimento dessas caracter√≠sticas pode orientar a escolha de t√©cnicas estat√≠sticas ou de machine learning que n√£o assumam normalidade dos dados.
Em resumo, a etapa de EDA proporcionou uma vis√£o abrangente da distribui√ß√£o dos dados, evidenciando que muitas vari√°veis apresentam distribui√ß√µes n√£o normais e alta variabilidade. Esses insights s√£o fundamentais para definir estrat√©gias de pr√©-processamento e escolher modelos que sejam adequados √†s caracter√≠sticas do dataset.

# üöÄ **7. Considera√ß√µes 1:

1. Carga e Convers√£o dos Dados
Carga:
Foram carregados 48.112 registros em 21 colunas.

Convers√£o de Colunas Temporais:
As colunas ‚Äúdata_inicio‚Äù e ‚Äúdata_final‚Äù foram convertidas para o formato datetime, permitindo opera√ß√µes temporais.

2. Estat√≠sticas Descritivas e Testes de Normalidade
Exemplos de Estat√≠sticas:
segundos_da_viagem:
M√©dia ‚âà 1053,71, Mediana = 859, Desvio padr√£o ‚âà 800, IQR = 856.
A alta assimetria (‚âà 11,33) e os p‚Äëvalores 0.0 nos testes de normalidade (Shapiro-Wilk e KS) indicam uma distribui√ß√£o fortemente enviesada.
milhas_da_viagem:
M√©dia ‚âà 5,88, Mediana = 3,6, Desvio padr√£o ‚âà 6,61 e assimetria de 3,86.
tarifa:
M√©dia ‚âà 10,90, Mediana = 7,5, Desvio padr√£o ‚âà 9,30 e assimetria de 3,72.
gorjeta:
M√©dia ‚âà 0,56, Mediana = 0, e assimetria elevada (‚âà 4,68).
Testes de Normalidade:
Para praticamente todas as vari√°veis num√©ricas, os testes Shapiro‚ÄëWilk e Kolmogorov‚ÄëSmirnov retornaram p‚Äëvalores iguais a 0.0, rejeitando a hip√≥tese de normalidade.
3. Valores Ausentes e Imputa√ß√£o
Percentual de Ausentes:

A maioria das colunas possui 0% de valores ausentes, exceto:
trato_do_censo_do_embarque: 28,84%
trato_do_censo_do_desembarque: 29,01%
area_comunitaria_do_embarque: 5,92%
area_comunitaria_do_desembarque: 6,36%
Latitude/Longitude dos centroides: entre 5,85% e 6,29%
Tratamento:

Para colunas com poucos ausentes (<10%), foi utilizada a imputa√ß√£o simples pela mediana (para num√©ricas) ou pela moda (para categ√≥ricas).
Para as colunas ‚Äútrato_do_censo_do_embarque‚Äù e ‚Äútrato_do_censo_do_desembarque‚Äù, que apresentam quase 29% de ausentes, foi aplicada imputa√ß√£o multivariada (IterativeImputer), conforme indicado nos warnings.
Ap√≥s o tratamento, todos os campos ficaram sem valores ausentes, conforme os logs.
4. Corre√ß√£o de Discrep√¢ncias Temporais
Foram identificados 2 registros onde ‚Äúdata_inicio‚Äù era maior que ‚Äúdata_final‚Äù.
O pipeline corrigiu automaticamente esses registros invertendo os valores das colunas correspondentes, garantindo a consist√™ncia temporal dos dados.
5. Detec√ß√£o de Outliers
M√©todo IQR e Z-score:
Para cada coluna num√©rica, foram aplicados os dois m√©todos para identificar outliers.
Por exemplo, na coluna ‚Äúsegundos_da_viagem‚Äù:
M√©todo IQR: 1916 outliers encontrados (limites: -762 e 2662).
M√©todo Z-score: 609 outliers (|z| > 3).
Outliers tamb√©m foram detectados em ‚Äúmilhas_da_viagem‚Äù, ‚Äútarifa‚Äù, ‚Äúgorjeta‚Äù, ‚Äúcobrancas_adicionais‚Äù, ‚Äútotal_da_viagem‚Äù e nas colunas de coordenadas.
Observa√ß√µes:
Em colunas como ‚Äútrato_do_censo_do_embarque‚Äù e ‚Äútrato_do_censo_do_desembarque‚Äù, embora os testes de outlier n√£o tenham apresentado valores (usando z-score), o m√©todo IQR encontrou um n√∫mero razo√°vel de outliers (1512 e 1791, respectivamente).
Os n√∫meros elevados de outliers em algumas vari√°veis podem indicar que os dados t√™m uma alta variabilidade ou que existem valores extremos reais (ou possivelmente erros de medi√ß√£o) que devem ser analisados com cautela antes de us√°-los em modelos.
6. Outras Verifica√ß√µes
Valores Negativos:
N√£o foram encontrados valores negativos em colunas onde n√£o se esperam (como ‚Äútarifa‚Äù, ‚Äúgorjeta‚Äù, etc.).

Duplicatas:
N√£o foram encontrados registros duplicados.

Conclus√£o Geral
Integridade dos Dados:
O pipeline realizou corretamente a carga, convers√£o e renomea√ß√£o das colunas, garantindo que as datas estejam no formato correto e que os tipos de dados estejam otimizados.

Valores Ausentes:
O tratamento de valores ausentes foi aplicado com estrat√©gias diferenciadas: imputa√ß√£o simples para colunas com menos de 10% de ausentes e imputa√ß√£o multivariada (MICE) para colunas com altos percentuais, como ‚Äútrato_do_censo_do_embarque‚Äù e ‚Äútrato_do_censo_do_desembarque‚Äù. Essa abordagem minimiza o vi√©s potencial dos dados imputados.

Discrep√¢ncias Temporais:
A identifica√ß√£o e corre√ß√£o autom√°tica dos 2 registros com discrep√¢ncias temporais garantem a consist√™ncia dos dados para an√°lises futuras.

Outliers:
A detec√ß√£o dos outliers utilizando m√©todos IQR e z-score mostra que muitas vari√°veis apresentam um n√∫mero elevado de valores extremos. Essa situa√ß√£o sugere a necessidade de uma an√°lise adicional para decidir se esses valores devem ser tratados (por exemplo, removidos ou transformados) antes de utilizar os dados em modelos preditivos.

Em resumo, a sa√≠da dos logs demonstra que o pipeline executou todas as etapas propostas, mas tamb√©m destaca √°reas importantes para aten√ß√£o futura, principalmente a necessidade de analisar a natureza dos outliers e o impacto dos altos percentuais de ausentes em determinadas colunas (especialmente as de censo) na an√°lise e modelagem. Essas informa√ß√µes s√£o cruciais para ajustar os m√©todos de pr√©-processamento e garantir a robustez dos modelos que ser√£o desenvolvidos posteriormente.